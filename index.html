<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Flashcard App - Old Style with Login</title>
<style>
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
    max-width: 700px;
    margin: auto;
    background: #f0f0f0;
  }
  h1, h2, h3 {
    font-weight: normal;
  }

  /* --- Login / Signup old style --- */
  #login-signup-container {
    background: white;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 30px;
  }
  #login-signup-container label {
    display: block;
    margin-top: 10px;
  }
  #login-signup-container input {
    padding: 8px;
    margin-top: 4px;
    width: 100%;
    box-sizing: border-box;
  }
  #login-signup-container button {
    margin-top: 15px;
    padding: 10px 20px;
    cursor: pointer;
  }

  /* --- Subjects container --- */
  #subjects-container {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
  }
  .subject-card {
    background-color: #558b2f; /* default color fallback */
    color: white;
    width: 140px;
    height: 120px;
    padding: 10px;
    border-radius: 8px;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    cursor: pointer;
    user-select: none;
    position: relative;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  }
  .subject-name {
    font-weight: bold;
    font-size: 18px;
    text-align: center;
  }
  .subject-actions {
    display: flex;
    justify-content: center;
    gap: 12px;
  }
  .subject-actions button {
    background: rgba(255 255 255 / 0.8);
    border: none;
    border-radius: 4px;
    padding: 6px 8px;
    cursor: pointer;
    font-size: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .subject-actions button svg {
    width: 18px;
    height: 18px;
    fill: #333;
  }

  /* --- Flashcards view --- */
  #flashcards-view {
    margin-top: 20px;
    background: white;
    border-radius: 8px;
    padding: 15px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }
  #flashcards-list {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
  }
  .flashcard {
    background-color: #0288d1; /* fallback */
    color: white;
    width: 140px;
    min-height: 90px;
    padding: 10px;
    border-radius: 8px;
    box-sizing: border-box;
    box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    position: relative;
  }
  .flashcard-content {
    font-size: 16px;
    margin-bottom: 8px;
  }
  .flashcard-actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
  }
  .flashcard-actions button {
    background: rgba(255 255 255 / 0.8);
    border: none;
    border-radius: 4px;
    padding: 6px 8px;
    cursor: pointer;
    font-size: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .flashcard-actions button svg {
    width: 18px;
    height: 18px;
    fill: #333;
  }

  /* Buttons */
  button {
    border: none;
    border-radius: 6px;
    background-color: #1976d2;
    color: white;
    padding: 8px 14px;
    font-size: 16px;
    cursor: pointer;
  }
  button:hover {
    background-color: #1565c0;
  }
  #flashcards-controls {
    margin-bottom: 10px;
  }
  #flashcards-controls button {
    margin-right: 8px;
  }
  .hidden {
    display: none !important;
  }
</style>
</head>
<body>

<!-- LOGIN / SIGNUP (old style) -->
<div id="login-signup-container">
  <h1>Login / Signup</h1>
  <label for="username-input">Username:</label>
  <input type="text" id="username-input" placeholder="Enter username" />
  
  <label for="password-input">Password:</label>
  <input type="password" id="password-input" placeholder="Enter password" />

  <button id="login-btn">Login</button>
</div>

<!-- MAIN APP -->
<div id="app-container" class="hidden">
  <button id="logout-btn">Logout</button>

  <h2>Your Subjects</h2>
  <div id="subjects-container"></div>
  <button id="add-subject-btn">Add Subject</button>

  <div id="flashcards-view" class="hidden">
    <button id="back-to-subjects-btn">‚Üê Back to Subjects</button>
    <h3 id="current-subject-title"></h3>
    <div id="flashcards-controls">
      <button id="add-flashcard-btn">Add Flashcard</button>
      <button id="shuffle-flashcards-btn">Shuffle Flashcards</button>
    </div>
    <div id="flashcards-list"></div>
  </div>
</div>

<script>
  // Basic users DB with username, password, and data
  let usersDB = {};
  let currentUser = null;
  let currentSubjectId = null;

  // Colors (old style - simpler colors)
  const subjectColors = ['#558b2f', '#e64a19', '#6a1b9a', '#0277bd', '#fbc02d', '#c2185b', '#00796b'];
  const flashcardColors = ['#0288d1', '#d32f2f', '#388e3c', '#f57c00', '#7b1fa2', '#c2185b', '#0097a7'];

  // Helper for non-repeating colors
  function getNonRepeatingColor(usedColors, colorPool) {
    const available = colorPool.filter(c => !usedColors.includes(c));
    if (available.length === 0) return colorPool[Math.floor(Math.random() * colorPool.length)];
    return available[Math.floor(Math.random() * available.length)];
  }

  // SVG icons for rename and delete (for reuse)
  const renameIconSVG = `
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M12 20h9" />
      <path d="M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4 12.5-12.5z" />
    </svg>`;
  const deleteIconSVG = `
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="3 6 5 6 21 6" />
      <path d="M19 6l-2 14H7L5 6" />
      <path d="M10 11v6" />
      <path d="M14 11v6" />
      <path d="M9 6V4h6v2" />
    </svg>`;

  // LOGIN / SIGNUP
  document.getElementById('login-btn').addEventListener('click', () => {
    const username = document.getElementById('username-input').value.trim();
    const password = document.getElementById('password-input').value;
    if (!username || !password) {
      alert('Please enter both username and password.');
      return;
    }

    if (usersDB[username]) {
      // User exists - check password
      if (usersDB[username].password !== password) {
        alert('Incorrect password!');
        return;
      }
    } else {
      // User does not exist - ask if wants to signup
      if (confirm(`User "${username}" not found. Would you like to sign up?`)) {
        usersDB[username] = {
          password,
          subjects: [{
            name: 'Welcome Subject',
            color: subjectColors[0],
            flashcards: []
          }]
        };
      } else {
        return; // stop login
      }
    }
    currentUser = username;
    // Hide login/signup form & show app
    document.getElementById('login-signup-container').classList.add('hidden');
    document.getElementById('app-container').classList.remove('hidden');
    renderSubjects();
  });

  // LOGOUT
  document.getElementById('logout-btn').addEventListener('click', () => {
    if (confirm('Logout? Unsaved data will be lost.')) {
      currentUser = null;
      currentSubjectId = null;
      document.getElementById('app-container').classList.add('hidden');
      document.getElementById('login-signup-container').classList.remove('hidden');
      document.getElementById('username-input').value = '';
      document.getElementById('password-input').value = '';
      // Clear views
      document.getElementById('subjects-container').innerHTML = '';
      document.getElementById('flashcards-list').innerHTML = '';
      document.getElementById('flashcards-view').classList.add('hidden');
    }
  });

  // RENDER SUBJECTS
  function renderSubjects() {
    currentSubjectId = null;
    document.getElementById('flashcards-view').classList.add('hidden');
    document.getElementById('subjects-container').innerHTML = '';
    document.getElementById('add-subject-btn').style.display = 'inline-block';

    const subjects = usersDB[currentUser].subjects;
    subjects.forEach((subject, idx) => {
      const card = document.createElement('div');
      card.className = 'subject-card';
      card.style.backgroundColor = subject.color;
      card.dataset.index = idx;

      const nameDiv = document.createElement('div');
      nameDiv.className = 'subject-name';
      nameDiv.textContent = subject.name;

      // Actions container: icons only Rename & Delete
      const actionsDiv = document.createElement('div');
      actionsDiv.className = 'subject-actions';

      const renameBtn = document.createElement('button');
      renameBtn.title = 'Rename Subject';
      renameBtn.innerHTML = renameIconSVG;
      renameBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        const newName = prompt('Enter new subject name:', subject.name);
        if (newName && newName.trim()) {
          subject.name = newName.trim();
          renderSubjects();
        }
      });

      const deleteBtn = document.createElement('button');
      deleteBtn.title = 'Delete Subject';
      deleteBtn.innerHTML = deleteIconSVG;
      deleteBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        if (confirm('Are you sure you want to delete this subject?')) {
          usersDB[currentUser].subjects.splice(idx, 1);
          renderSubjects();
        }
      });

      actionsDiv.appendChild(renameBtn);
      actionsDiv.appendChild(deleteBtn);

      card.appendChild(nameDiv);
      card.appendChild(actionsDiv);

      card.addEventListener('click', () => {
        openFlashcards(idx);
      });

      document.getElementById('subjects-container').appendChild(card);
    });
  }

  // OPEN FLASHCARDS
  const flashcardsView = document.getElementById('flashcards-view');
  const flashcardsList = document.getElementById('flashcards-list');
  const currentSubjectTitle = document.getElementById('current-subject-title');

  function openFlashcards(subjectId) {
    currentSubjectId = subjectId;
    const subject = usersDB[currentUser].subjects[subjectId];
    currentSubjectTitle.textContent = subject.name;
    flashcardsView.classList.remove('hidden');
    document.getElementById('subjects-container').innerHTML = '';
    document.getElementById('add-subject-btn').style.display = 'none';

    renderFlashcards();
  }

  // RENDER FLASHCARDS
  function renderFlashcards() {
    flashcardsList.innerHTML = '';
    const flashcards = usersDB[currentUser].subjects[currentSubjectId].flashcards;

    flashcards.forEach((card, i) => {
      const div = document.createElement('div');
      div.className = 'flashcard';
      div.style.backgroundColor = card.color;

      div.innerHTML = `
        <div class="flashcard-content">${card.content}</div>
        <div class="flashcard-actions">
          <button data-action="edit" data-index="${i}" title="Edit flashcard">${renameIconSVG}</button>
          <button data-action="delete" data-index="${i}" title="Delete flashcard">${deleteIconSVG}</button>
        </div>
      `;

      div.querySelectorAll('button').forEach(btn => {
        btn.addEventListener('click', e => {
          e.stopPropagation();
          const action = btn.getAttribute('data-action');
          const index = parseInt(btn.getAttribute('data-index'));
          if (action === 'edit') {
            const newContent = prompt('Edit flashcard content:', flashcards[index].content);
            if (newContent && newContent.trim()) {
              flashcards[index].content = newContent.trim();
              renderFlashcards();
            }
          } else if (action === 'delete') {
            if (confirm('Delete this flashcard?')) {
              flashcards.splice(index, 1);
              renderFlashcards();
            }
          }
        });
      });

      flashcardsList.appendChild(div);
    });
  }

  // ADD SUBJECT
  document.getElementById('add-subject-btn').addEventListener('click', () => {
    const newName = prompt('Enter new subject name:');
    if (newName && newName.trim()) {
      const usedColors = usersDB[currentUser].subjects.map(s => s.color);
      const newColor = getNonRepeatingColor(usedColors, subjectColors);
      usersDB[currentUser].subjects.push({
        name: newName.trim(),
        color: newColor,
        flashcards: []
      });
      renderSubjects();
    }
  });

  // ADD FLASHCARD
  document.getElementById('add-flashcard-btn').addEventListener('click', () => {
    if (currentSubjectId === null) return;
    const content = prompt('Enter flashcard content:');
    if (content && content.trim()) {
      const subject = usersDB[currentUser].subjects[currentSubjectId];
      const usedColors = subject.flashcards.map(fc => fc.color);
      const newColor = getNonRepeatingColor(usedColors, flashcardColors);
      subject.flashcards.push({
        content: content.trim(),
        color: newColor
      });
      renderFlashcards();
    }
  });

  // SHUFFLE FLASHCARDS
  document.getElementById('shuffle-flashcards-btn').addEventListener('click', () => {
    if (currentSubjectId === null) return;
    const flashcards = usersDB[currentUser].subjects[currentSubjectId].flashcards;
    for (let i = flashcards.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [flashcards[i], flashcards[j]] = [flashcards[j], flashcards[i]];
    }
    renderFlashcards();
  });

  // BACK TO SUBJECTS
  document.getElementById('back-to-subjects-btn').addEventListener('click', () => {
    currentSubjectId = null;
    document.getElementById('flashcards-view').classList.add('hidden');
    document.getElementById('add-subject-btn').style.display = 'inline-block';
    renderSubjects();
  });
</script>

</body>
</html>
