<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Flashcard Hub</title>
  <style>
    :root {
      --primary-color: #00bcd4;
      --secondary-color: #e0f7fa;
      --text-color: #333;
      --light-gray: #f5f5f5;
      --medium-gray: #e0e0e0;
      --dark-gray: #757575;
    }
    
    * {
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #fdfbfb, #ebedee);
      margin: 0;
      padding: 0;
      color: var(--text-color);
    }
    
    header {
      background: var(--primary-color);
      color: white;
      padding: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
    }
    
    .menu-btn {
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      padding: 0.5rem;
    }
    
    .menu {
      position: absolute;
      top: 100%;
      right: 1rem;
      background: white;
      border-radius: 5px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      width: 200px;
      z-index: 100;
      display: none;
    }
    
    .menu.show {
      display: block;
    }
    
    .menu-item {
      padding: 0.75rem 1rem;
      cursor: pointer;
      border-bottom: 1px solid var(--medium-gray);
    }
    
    .menu-item:last-child {
      border-bottom: none;
    }
    
    .menu-item:hover {
      background: var(--light-gray);
    }
    
    #auth-section {
      max-width: 400px;
      margin: 2rem auto;
      padding: 2rem;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .auth-title {
      text-align: center;
      color: var(--primary-color);
      margin-bottom: 1.5rem;
    }
    
    .auth-form {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    
    .auth-input {
      padding: 0.75rem;
      border: 1px solid var(--medium-gray);
      border-radius: 5px;
      font-size: 1rem;
    }
    
    .auth-input:focus {
      outline: none;
      border-color: var(--primary-color);
    }
    
    .auth-button {
      background: var(--primary-color);
      color: white;
      border: none;
      padding: 0.75rem;
      border-radius: 5px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.3s;
    }
    
    .auth-button:hover {
      background: #0097a7;
    }
    
    .auth-toggle {
      text-align: center;
      color: var(--dark-gray);
      margin-top: 1rem;
    }
    
    .auth-toggle span {
      color: var(--primary-color);
      cursor: pointer;
      text-decoration: underline;
    }
    
    #main, #subject-view, #account-settings, #change-password {
      padding: 1rem;
      display: none;
      max-width: 800px;
      margin: 0 auto;
    }
    
    .section-title {
      font-size: 1.2rem;
      margin-bottom: 1rem;
      color: var(--primary-color);
    }
    
    .search-bar {
      width: 100%;
      padding: 0.75rem;
      margin-bottom: 1rem;
      border: 1px solid var(--medium-gray);
      border-radius: 5px;
      font-size: 1rem;
    }
    
    .action-buttons {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }
    
    .btn {
      padding: 0.75rem 1rem;
      font-size: 1rem;
      background: var(--secondary-color);
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .btn:hover {
      background: #b2ebf2;
      transform: translateY(-2px);
    }
    
    .btn-primary {
      background: var(--primary-color);
      color: white;
    }
    
    .btn-primary:hover {
      background: #0097a7;
    }
    
    .subject, .flashcard {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
      margin: 0.5rem 0;
      border-radius: 10px;
      background-color: white;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    
    .subject:hover, .flashcard:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .tools {
      display: flex;
      gap: 0.5rem;
    }
    
    .tool-btn {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      color: var(--dark-gray);
      transition: color 0.3s;
    }
    
    .tool-btn:hover {
      color: var(--primary-color);
    }
    
    .subject-container, .flashcard-container {
      margin-top: 1rem;
    }
    
    .settings-form {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    
    .form-label {
      font-weight: 500;
    }
    
    .form-input {
      padding: 0.75rem;
      border: 1px solid var(--medium-gray);
      border-radius: 5px;
      font-size: 1rem;
    }
    
    .form-input:focus {
      outline: none;
      border-color: var(--primary-color);
    }
    
    .back-btn {
      margin-bottom: 1rem;
    }
    
    @media (max-width: 600px) {
      header {
        padding: 0.75rem;
      }
      
      #auth-section {
        padding: 1.5rem;
        margin: 1rem;
      }
      
      .btn {
        padding: 0.5rem;
        font-size: 0.9rem;
      }
      
      .subject, .flashcard {
        padding: 0.75rem;
      }
    }
  </style>
</head>
<body>

<header>
  <h1>üìö Flashcard Hub</h1>
  <button class="menu-btn" id="menuBtn">‚ò∞</button>
  <div class="menu" id="menu">
    <div class="menu-item" onclick="showAccountSettings()">Account Settings</div>
    <div class="menu-item" onclick="showChangePassword()">Change Password</div>
    <div class="menu-item" onclick="logout()" style="color: #f44336;">Logout</div>
  </div>
</header>

<!-- Auth Section -->
<div id="auth-section">
  <h2 class="auth-title" id="authTitle">Sign In</h2>
  <div class="auth-form">
    <input type="text" id="username" class="auth-input" placeholder="Username" required>
    <input type="password" id="password" class="auth-input" placeholder="Password" required>
    <button onclick="handleAuth()" class="auth-button" id="auth-button">Sign In</button>
    <div class="auth-toggle">
      <span id="authToggleText" onclick="toggleAuth()">Don't have an account? Sign Up</span>
    </div>
  </div>
</div>

<!-- Main Dashboard -->
<div id="main">
  <input type="text" id="searchInput" class="search-bar" placeholder="üîç Search subjects..." oninput="filterSubjects()">
  <div class="action-buttons">
    <button class="btn btn-primary" onclick="addSubject()">
      <span>‚ûï</span> Add Subject
    </button>
  </div>
  <div class="section-title">üìÅ Your Subjects:</div>
  <div class="subject-container" id="subjectContainer"></div>
</div>

<!-- Subject View -->
<div id="subject-view">
  <button class="btn back-btn" onclick="backToMain()">‚¨Ö Back to Subjects</button>
  <h2 id="subjectTitle"></h2>
  <div class="action-buttons">
    <button class="btn btn-primary" onclick="addFlashcard()">
      <span>‚ûï</span> Add Flashcard
    </button>
    <button class="btn" onclick="shuffleFlashcards()">
      <span>üîÄ</span> Shuffle
    </button>
  </div>
  <div class="flashcard-container" id="flashcardContainer"></div>
</div>

<!-- Account Settings -->
<div id="account-settings">
  <button class="btn back-btn" onclick="backToMainFromSettings()">‚¨Ö Back</button>
  <h2>Account Settings</h2>
  <div class="settings-form">
    <div class="form-group">
      <label class="form-label">Name</label>
      <input type="text" id="userName" class="form-input">
    </div>
    <div class="form-group">
      <label class="form-label">Phone Number</label>
      <input type="tel" id="userPhone" class="form-input">
    </div>
    <div class="form-group">
      <label class="form-label">Address</label>
      <textarea id="userAddress" class="form-input" rows="3"></textarea>
    </div>
    <button class="btn btn-primary" onclick="saveAccountSettings()">Save Changes</button>
  </div>
</div>

<!-- Change Password -->
<div id="change-password">
  <button class="btn back-btn" onclick="backToMainFromSettings()">‚¨Ö Back</button>
  <h2>Change Password</h2>
  <div class="settings-form">
    <div class="form-group">
      <label class="form-label">Current Password</label>
      <input type="password" id="currentPassword" class="form-input" required>
    </div>
    <div class="form-group">
      <label class="form-label">New Password</label>
      <input type="password" id="newPassword" class="form-input" required>
    </div>
    <div class="form-group">
      <label class="form-label">Confirm New Password</label>
      <input type="password" id="confirmPassword" class="form-input" required>
    </div>
    <button class="btn btn-primary" onclick="changePassword()">Change Password</button>
  </div>
</div>

<script>
// Global variables
let isSignup = false;
let currentUser = null;
let currentSubject = null;
let subjectColors = ['#ffecb3', '#c8e6c9', '#ffcdd2', '#b2ebf2', '#e1bee7', '#f0f4c3'];
let flashcardColors = ['#ffe0b2', '#dcedc8', '#f8bbd0', '#b2dfdb', '#d1c4e9', '#fff9c4'];

// DOM Elements
const menuBtn = document.getElementById('menuBtn');
const menu = document.getElementById('menu');

// Event Listeners
menuBtn.addEventListener('click', () => {
  menu.classList.toggle('show');
});

// Close menu when clicking outside
document.addEventListener('click', (e) => {
  if (!menu.contains(e.target) && e.target !== menuBtn) {
    menu.classList.remove('show');
  }
});

// Toggle between sign in and sign up
function toggleAuth() {
  isSignup = !isSignup;
  document.getElementById('auth-button').innerText = isSignup ? 'Sign Up' : 'Sign In';
  document.getElementById('authTitle').innerText = isSignup ? 'Sign Up' : 'Sign In';
  document.getElementById('authToggleText').innerText = isSignup ? 
    'Already have an account? Sign In' : "Don't have an account? Sign Up";
}

// Handle authentication
function handleAuth() {
  const user = document.getElementById('username').value.trim();
  const pass = document.getElementById('password').value.trim();
  
  if (!user || !pass) {
    alert('Please enter both username and password');
    return;
  }
  
  let users = JSON.parse(localStorage.getItem('users') || '{}');
  
  if (isSignup) {
    if (users[user]) {
      alert('User already exists!');
    } else {
      users[user] = { 
        password: pass, 
        data: {},
        profile: {
          name: '',
          phone: '',
          address: ''
        }
      };
      localStorage.setItem('users', JSON.stringify(users));
      alert('Signup successful! Please sign in.');
      toggleAuth(); // Switch back to sign in
    }
  } else {
    if (users[user] && users[user].password === pass) {
      currentUser = user;
      document.getElementById('auth-section').style.display = 'none';
      document.getElementById('main').style.display = 'block';
      loadSubjects();
      loadProfileData();
    } else {
      alert('Incorrect credentials.');
    }
  }
  
  // Clear fields
  document.getElementById('username').value = '';
  document.getElementById('password').value = '';
}

// Get user data
function getUserData() {
  let users = JSON.parse(localStorage.getItem('users'));
  return users[currentUser].data;
}

// Get user profile
function getUserProfile() {
  let users = JSON.parse(localStorage.getItem('users'));
  return users[currentUser].profile || { name: '', phone: '', address: '' };
}

// Save user data
function saveUserData(data) {
  let users = JSON.parse(localStorage.getItem('users'));
  users[currentUser].data = data;
  localStorage.setItem('users', JSON.stringify(users));
}

// Save user profile
function saveUserProfile(profile) {
  let users = JSON.parse(localStorage.getItem('users'));
  users[currentUser].profile = profile;
  localStorage.setItem('users', JSON.stringify(users));
}

// Load profile data into form
function loadProfileData() {
  const profile = getUserProfile();
  document.getElementById('userName').value = profile.name || '';
  document.getElementById('userPhone').value = profile.phone || '';
  document.getElementById('userAddress').value = profile.address || '';
}

// Add a new subject
function addSubject() {
  let name = prompt('Subject Name:');
  if (name) {
    let data = getUserData();
    const color = subjectColors[Math.floor(Math.random() * subjectColors.length)];
    data[name] = { flashcards: [], color };
    saveUserData(data);
    loadSubjects();
  }
}

// Load all subjects
function loadSubjects() {
  const container = document.getElementById('subjectContainer');
  container.innerHTML = '';
  const data = getUserData();
  
  if (Object.keys(data).length === 0) {
    container.innerHTML = '<p>No subjects found. Add your first subject!</p>';
    return;
  }
  
  for (let subject in data) {
    const div = document.createElement('div');
    div.className = 'subject';
    div.style.backgroundColor = data[subject].color;
    div.innerHTML = `<span>${subject}</span>
      <div class="tools">
        <button class="tool-btn" onclick="event.stopPropagation(); renameSubject('${subject}')">‚úèÔ∏è</button>
        <button class="tool-btn" onclick="event.stopPropagation(); deleteSubject('${subject}')">üóëÔ∏è</button>
      </div>`;
    div.onclick = () => openSubject(subject);
    container.appendChild(div);
  }
}

// Rename a subject
function renameSubject(name) {
  let newName = prompt('New name:', name);
  if (newName && newName !== name) {
    let data = getUserData();
    data[newName] = data[name];
    delete data[name];
    saveUserData(data);
    loadSubjects();
  }
}

// Delete a subject
function deleteSubject(name) {
  if (confirm(`Are you sure you want to delete "${name}" and all its flashcards?`)) {
    let data = getUserData();
    delete data[name];
    saveUserData(data);
    loadSubjects();
  }
}

// Open a subject to view flashcards
function openSubject(name) {
  currentSubject = name;
  document.getElementById('main').style.display = 'none';
  document.getElementById('subject-view').style.display = 'block';
  document.getElementById('subjectTitle').innerText = name;
  loadFlashcards();
}

// Go back to main view from subject view
function backToMain() {
  document.getElementById('subject-view').style.display = 'none';
  document.getElementById('main').style.display = 'block';
  currentSubject = null;
}

// Add a new flashcard
function addFlashcard() {
  let content = prompt('Enter flashcard content:');
  if (content) {
    let data = getUserData();
    const color = flashcardColors[Math.floor(Math.random() * flashcardColors.length)];
    data[currentSubject].flashcards.push({ content, color });
    saveUserData(data);
    loadFlashcards();
  }
}

// Load all flashcards for current subject
function loadFlashcards() {
  const container = document.getElementById('flashcardContainer');
  container.innerHTML = '';
  let data = getUserData();
  const flashcards = data[currentSubject].flashcards;
  
  if (flashcards.length === 0) {
    container.innerHTML = '<p>No flashcards found. Add your first flashcard!</p>';
    return;
  }
  
  flashcards.forEach((card, i) => {
    const div = document.createElement('div');
    div.className = 'flashcard';
    div.style.backgroundColor = card.color;
    div.innerHTML = `<span>${card.content}</span>
      <div class="tools">
        <button class="tool-btn" onclick="event.stopPropagation(); renameFlashcard(${i})">‚úèÔ∏è</button>
        <button class="tool-btn" onclick="event.stopPropagation(); deleteFlashcard(${i})">üóëÔ∏è</button>
      </div>`;
    container.appendChild(div);
  });
}

// Rename a flashcard
function renameFlashcard(i) {
  let data = getUserData();
  let newText = prompt('Update flashcard:', data[currentSubject].flashcards[i].content);
  if (newText) {
    data[currentSubject].flashcards[i].content = newText;
    saveUserData(data);
    loadFlashcards();
  }
}

// Delete a flashcard
function deleteFlashcard(i) {
  if (confirm('Delete this flashcard?')) {
    let data = getUserData();
    data[currentSubject].flashcards.splice(i, 1);
    saveUserData(data);
    loadFlashcards();
  }
}

// Shuffle flashcards
function shuffleFlashcards() {
  let data = getUserData();
  let cards = data[currentSubject].flashcards;
  for (let i = cards.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [cards[i], cards[j]] = [cards[j], cards[i]];
  }
  saveUserData(data);
  loadFlashcards();
}

// Filter subjects by search query
function filterSubjects() {
  const query = document.getElementById('searchInput').value.toLowerCase();
  document.querySelectorAll('.subject').forEach(el => {
    el.style.display = el.textContent.toLowerCase().includes(query) ? 'flex' : 'none';
  });
}

// Show account settings
function showAccountSettings() {
  document.getElementById('main').style.display = 'none';
  document.getElementById('subject-view').style.display = 'none';
  document.getElementById('change-password').style.display = 'none';
  document.getElementById('account-settings').style.display = 'block';
  menu.classList.remove('show');
}

// Show change password form
function showChangePassword() {
  document.getElementById('main').style.display = 'none';
  document.getElementById('subject-view').style.display = 'none';
  document.getElementById('account-settings').style.display = 'none';
  document.getElementById('change-password').style.display = 'block';
  menu.classList.remove('show');
}

// Back to main from settings
function backToMainFromSettings() {
  document.getElementById('account-settings').style.display = 'none';
  document.getElementById('change-password').style.display = 'none';
  document.getElementById('main').style.display = 'block';
}

// Save account settings
function saveAccountSettings() {
  const profile = {
    name: document.getElementById('userName').value.trim(),
    phone: document.getElementById('userPhone').value.trim(),
    address: document.getElementById('userAddress').value.trim()
  };
  
  saveUserProfile(profile);
  alert('Profile updated successfully!');
}

// Change password
function changePassword() {
  const currentPass = document.getElementById('currentPassword').value;
  const newPass = document.getElementById('newPassword').value;
  const confirmPass = document.getElementById('confirmPassword').value;
  
  let users = JSON.parse(localStorage.getItem('users'));
  
  if (users[currentUser].password !== currentPass) {
    alert('Current password is incorrect');
    return;
  }
  
  if (newPass !== confirmPass) {
    alert('New passwords do not match');
    return;
  }
  
  if (newPass.length < 6) {
    alert('Password should be at least 6 characters');
    return;
  }
  
  users[currentUser].password = newPass;
  localStorage.setItem('users', JSON.stringify(users));
  
  alert('Password changed successfully!');
  document.getElementById('currentPassword').value = '';
  document.getElementById('newPassword').value = '';
  document.getElementById('confirmPassword').value = '';
}

// Logout
function logout() {
  currentUser = null;
  document.getElementById('main').style.display = 'none';
  document.getElementById('subject-view').style.display = 'none';
  document.getElementById('account-settings').style.display = 'none';
  document.getElementById('change-password').style.display = 'none';
  document.getElementById('auth-section').style.display = 'block';
  menu.classList.remove('show');
}
</script>

</body>
</html>